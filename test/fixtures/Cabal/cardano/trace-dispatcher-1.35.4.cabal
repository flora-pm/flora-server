cabal-version:      2.4
name:               trace-dispatcher
version:            1.35.4
copyright:          2020 IOHK
maintainer:         operations@iohk.io
author:             Juergen Nicklisch-Franken
synopsis:
    Package for development of simple and efficient tracers
    based on the arrow based contra-tracer package

extra-source-files:
    CHANGELOG.md
    README.md
    doc/trace-dispatcher.md

library
    exposed-modules:
        Cardano.Logging
        Cardano.Logging.Types
        Cardano.Logging.Trace
        Cardano.Logging.Configuration
        Cardano.Logging.ConfigurationParser
        Cardano.Logging.DocuGenerator
        Cardano.Logging.Formatter
        Cardano.Logging.Forwarding
        Cardano.Logging.FrequencyLimiter
        Cardano.Logging.Tracer.DataPoint
        Cardano.Logging.Tracer.EKG
        Cardano.Logging.Tracer.Standard
        Cardano.Logging.Tracer.Forward
        Cardano.Logging.Tracer.Composed
        Cardano.Logging.Utils
        Cardano.Logging.Version
        Control.Tracer.Arrow
        Control.Tracer

    hs-source-dirs:     src
    default-language:   Haskell2010
    default-extensions: OverloadedStrings
    ghc-options:
        -Wall -Wcompat -Wincomplete-uni-patterns
        -Wincomplete-record-updates -Wpartial-fields -Widentities
        -Wredundant-constraints -Wmissing-export-lists
        -Wno-incomplete-patterns

    build-depends:
        base >=4.12 && <5,
        aeson,
        async,
        bytestring,
        cborg,
        containers,
        contra-tracer,
        ekg,
        ekg-core,
        ekg-forward ==0.1.0,
        hostname,
        network,
        optparse-applicative-fork,
        ouroboros-network,
        ouroboros-network-framework,
        serialise,
        stm,
        text,
        time,
        trace-forward,
        unagi-chan >=0.4.1.4,
        unliftio,
        unliftio-core,
        unordered-containers,
        yaml

    if os(windows)
        build-depends: Win32

    else
        build-depends: unix

executable trace-dispatcher-examples
    main-is:            Main.hs
    hs-source-dirs:     examples
    other-modules:
        Examples.TestObjects
        Examples.Aggregation
        Examples.Trivial
        Examples.Routing
        Examples.EKG
        Examples.Configuration
        Examples.DataPoint
        Examples.FrequencyLimiting
        Examples.Documentation

    default-language:   Haskell2010
    default-extensions: OverloadedStrings
    ghc-options:
        -Wall -Wcompat -Wincomplete-uni-patterns
        -Wincomplete-record-updates -Wpartial-fields -Widentities
        -Wredundant-constraints -Wmissing-export-lists
        -Wno-incomplete-patterns

    build-depends:
        base >=4.12 && <5,
        aeson,
        bytestring,
        containers,
        ekg,
        ekg-core,
        hostname,
        stm,
        text,
        trace-dispatcher,
        trace-forward,
        time,
        unagi-chan >=0.4.1.4,
        unliftio,
        unliftio-core,
        unordered-containers,
        utf8-string,
        yaml

test-suite trace-dispatcher-test
    type:               exitcode-stdio-1.0
    main-is:            trace-dispatcher-test.hs
    hs-source-dirs:     test
    other-modules:
        Cardano.Logging.Test.Types
        Cardano.Logging.Test.Oracles
        Cardano.Logging.Test.Config
        Cardano.Logging.Test.Tracer
        Cardano.Logging.Test.Messages
        Cardano.Logging.Test.Script

    default-language:   Haskell2010
    default-extensions: OverloadedStrings
    ghc-options:
        -Wall -Wcompat -Wincomplete-uni-patterns
        -Wincomplete-record-updates -Wpartial-fields -Widentities
        -Wredundant-constraints -Wmissing-export-lists
        -Wno-incomplete-patterns

    build-depends:
        base >=4.12 && <5,
        aeson,
        bytestring,
        containers,
        ekg,
        ekg-core,
        hostname,
        text,
        stm,
        tasty,
        tasty-quickcheck,
        time,
        trace-dispatcher,
        unagi-chan >=0.4.1.4,
        unliftio,
        unliftio-core,
        unordered-containers,
        yaml,
        QuickCheck

benchmark trace-dispatcher-bench
    type:               exitcode-stdio-1.0
    main-is:            trace-dispatcher-bench.hs
    hs-source-dirs:     bench test
    other-modules:
        Cardano.Logging.Test.Types
        Cardano.Logging.Test.Oracles
        Cardano.Logging.Test.Config
        Cardano.Logging.Test.Tracer
        Cardano.Logging.Test.Messages
        Cardano.Logging.Test.Script

    default-language:   Haskell2010
    default-extensions: OverloadedStrings
    build-depends:
        base >=4.12 && <5,
        aeson,
        containers,
        criterion,
        ekg,
        text,
        time,
        trace-dispatcher,
        QuickCheck
